/**
 *      @file    cryptoCheck.h
 *
 *
 *      Configuration validation/sanity checks.
 */
/*
 *      Copyright (c) 2013-2018 INSIDE Secure Corporation
 *      All Rights Reserved
 *
 *      THIS IS UNPUBLISHED PROPRIETARY SOURCE CODE OF INSIDE.
 *
 *      Please do not edit this file without first consulting INSIDE support.
 *      Unauthorized changes to this file are not supported by INSIDE.
 *
 *      The copyright notice above does not evidence any actual or intended
 *      publication of such source code.
 *
 *      This Module contains Proprietary Information of INSIDE and should be
 *      treated as Confidential.
 *
 *      The information in this file is provided for the exclusive use of the
 *      licensees of INSIDE. Such users have the right to use, modify,
 *      and incorporate this code into products for purposes authorized by the
 *      license agreement provided they include this notice and the associated
 *      copyright notice with any such product.
 *
 *      The information in this file is provided "AS IS" without warranty.
 */
/******************************************************************************/

#ifndef _h_PS_CRYPTOCHECK
# define _h_PS_CRYPTOCHECK

/******************************************************************************/
/*
 */
# ifdef USE_CERT_PARSE
#  ifndef USE_X509
#   error "Must enable USE_X509 if USE_CERT_PARSE is enabled"
#  endif
#  if !defined(USE_MD5) && !defined(USE_SHA1) && !defined(USE_SHA256)
#   error "At least one of USE_MD5, USE_SHA1 or USE_SHA256 must be enabled for USE_CERT_PARSE"
#  endif
# endif

# ifdef USE_PBKDF1
#  ifndef USE_PKCS5
#   error "Enable USE_PKCS5 in cryptoConfig.h for PKBDF1 support"
#  endif
# endif

# ifdef USE_PKCS5
#  ifdef USE_PBKDF1
#   ifndef USE_MD5
#    error "Enable USE_MD5 in cryptoConfig.h for PBKDF1 support"
#   endif
#  endif
#  ifndef USE_3DES
#   error "Enable USE_3DES in cryptoConfig.h for PKCS5 support"
#  endif
#  ifndef USE_AES
#   error "Enable USE_AES in cryptoConfig.h for PKCS5 support"
#  endif
# endif

# ifdef USE_PKCS8
#  ifndef USE_HMAC_SHA1
#   error "Enable USE_HMAC_SHA1 in cryptoConfig.h for PKCS8 support"
#  endif
# endif

#  define USE_NATIVE_ECC
#  define USE_NATIVE_AES
#  define USE_NATIVE_HASH

# ifdef USE_PKCS12
#  ifndef USE_PKCS8
#   error "Enable USE_PKCS8 in cryptoConfig.h for PKCS12 support"
#  endif
# else
#  ifdef USE_RC2
#   error "RC2 only allowed for PKCS12 support"
#  endif
# endif

# ifdef USE_ED25519
#  ifndef USE_SHA512
#   error "Enable USE_SHA512 for Ed25519 support"
#  endif
# endif

# ifdef USE_CMS
#  ifndef USE_CERT_PARSE
#   error "Enable USE_CERT_PARSE in cryptoConfig.h for CMS support"
#  endif
# endif

# ifdef USE_CERT_PARSE
#  ifndef USE_X509
#   error "USE_X509 required for USE_CERT_PARSE"
#  endif
# endif

# ifdef USE_FULL_CERT_PARSE
#  ifndef USE_CERT_PARSE
#   error "USE_CERT_PARSE required for USE_FULL_CERT_PARSE"
#  endif
# endif

# ifdef ENABLE_CA_CERT_HASH
#  if !defined(USE_SHA1) || !defined(USE_X509)
#   error "USE_SHA1 and USE_X509 required for ENABLE_CA_CERT_HASH"
#  endif
# endif

# ifdef USE_OCSP_RESPONSE
#  ifndef USE_SHA1
#   error "Enable USE_SHA1 in cryptoConfig.h for OCSP support"
#  endif
#  ifndef USE_CERT_PARSE
#    errro "enable USE_CERT_PARSE for USE_OCSP_RESPONSE."
#  endif
# endif

# ifdef USE_OCSP_REQUEST
#  ifndef USE_SHA1
#   error "Enable USE_SHA1 in cryptoConfig.h for OCSP support"
#  endif
#  ifndef USE_CERT_GEN
#   error "Enable USE_CERT_GEN in cryptoConfig.h for USE_OCSP_REQUEST"
#  endif
# endif

#endif  /* _h_PS_CRYPTOCHECK */

/******************************************************************************/
